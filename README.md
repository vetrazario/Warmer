# Email Warmer

Сервис для прогрева email-аккаунтов путем автоматической отправки писем между ними.

## Быстрая установка на Ubuntu 22.04

### 1. Скачайте установочный скрипт

```bash
wget -O install.sh https://raw.githubusercontent.com/ваш-аккаунт/email-warmer/main/install.sh
chmod +x install.sh
```

### 2. Запустите скрипт установки

```bash
sudo ./install.sh
```

Скрипт запросит необходимую информацию и автоматически настроит все компоненты:
- Домен или IP-адрес сервера
- Настройку SSL (рекомендуется)
- URL вашего Git-репозитория
- Порт для приложения
- Секретные ключи (можно сгенерировать автоматически)

### 3. Проверка работы

После установки приложение будет доступно по указанному домену или IP-адресу.

Для проверки статуса используйте:
```bash
/var/www/email-warmer/status.sh
```

## Управление приложением

### Обновление приложения

```bash
/var/www/email-warmer/update.sh
```

### Автоматическое обновление через webhook

Для настройки автоматического обновления из Git-репозитория при push-событиях:

```bash
wget -O setup_webhook.sh https://raw.githubusercontent.com/ваш-аккаунт/email-warmer/main/setup_webhook.sh
chmod +x setup_webhook.sh
sudo ./setup_webhook.sh
```

После настройки webhook вы получите секретный токен и URL, которые нужно добавить в настройки вашего репозитория на GitHub/GitLab.

### Восстановление из резервной копии

Если вам необходимо восстановить приложение из резервной копии:

```bash
wget -O restore.sh https://raw.githubusercontent.com/ваш-аккаунт/email-warmer/main/restore.sh
chmod +x restore.sh
sudo ./restore.sh
```

Скрипт восстановления покажет список доступных резервных копий и позволит выбрать, из какой копии провести восстановление.

### Просмотр логов

```bash
# Логи приложения
/var/www/email-warmer/logs.sh

# Логи автоматического обновления
sudo tail -f /var/log/email-warmer/auto_update.log
```

### Перезапуск приложения

```bash
sudo systemctl restart email-warmer
# или
/var/www/email-warmer/restart.sh
```

## Резервное копирование

Резервные копии создаются автоматически каждый день в 2:00 в директории `/var/backups/email-warmer`.

Для ручного создания резервной копии:
```bash
/var/www/email-warmer/backup.sh
```

## Устранение проблем

### Проблема с контекстом приложения Flask

Если в логах появляются ошибки "Working outside of application context", отредактируйте файл `app/services/scheduler.py` и оберните код в контекст приложения:

```python
with app.app_context():
    # код, который работает с Flask-контекстом
```

### Проблемы с базой данных

Если возникают ошибки с базой данных, проверьте права доступа:

```bash
sudo chown -R www-data:www-data /var/data/mongodb
```

### Проблемы с Docker

Если контейнеры не запускаются:

```bash
# Проверка статуса Docker
sudo systemctl status docker

# Перезапуск Docker
sudo systemctl restart docker
```

## Подробное руководство по развертыванию

Для более подробной информации о процессе развертывания, настройки и обслуживания приложения, смотрите файл [DEPLOY.md](DEPLOY.md).

## Структура приложения

- `app/` - основной код приложения
  - `models/` - модели данных
  - `routes/` - маршруты API и веб-интерфейса
  - `services/` - сервисы для работы с email и планировщиком
  - `static/` - статические файлы (CSS, JavaScript)
  - `templates/` - шаблоны HTML
- `scripts/` - скрипты для установки и управления
- `instance/` - директория с базой данных
- `venv/` - виртуальное окружение Python

## Описание

Email Warmer - это веб-приложение, которое помогает повысить репутацию ваших email-аккаунтов путем постепенного увеличения объема отправляемых писем. Система автоматически отправляет письма между вашими серверами, имитируя реальную переписку, что позволяет:

- Повысить репутацию отправителя у почтовых провайдеров
- Улучшить доставляемость писем в папку "Входящие"
- Снизить вероятность попадания писем в спам
- Отслеживать прогресс прогрева в реальном времени

## Функциональность

- Управление SMTP-серверами
- Создание и настройка кампаний прогрева
- Автоматическая отправка писем по расписанию
- Постепенное увеличение объема отправляемых писем
- Отслеживание статистики доставки, открытий и ответов
- Детальная аналитика по каждой кампании

## Требования

- Ubuntu 22.04 LTS
- Docker и Docker Compose
- Nginx
- Доступ к SMTP-серверам для отправки писем

## Лицензия

MIT License 